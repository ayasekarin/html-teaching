
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>発注管理システム - 発注一覧</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background-color: #f4f6f9;
        }
        .sidebar {
            height: 100vh;
            background-color: #343a40;
            color: white;
            padding: 1rem;
            min-width: 240px;
        }
        .sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            margin: 0.8rem 0;
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
        }
        .sidebar a:hover,
        .sidebar a.active {
            background-color: #495057;
        }
        .topbar {
            background-color: white;
            padding: 1rem 2rem;
            border-bottom: 1px solid #dee2e6;
        }
        .badge-status {
            font-size: 0.85rem;
        }
        .main {
            padding: 2rem;
            flex-grow: 1;
        }
        .search-area .form-control {
            margin-bottom: 10px;
        }
        .table thead {
            background-color: #0d6efd;
            color: white;
        }
        .action-buttons button {
            margin-right: 5px;
        }
        .pagination-info {
            font-size: 0.9rem;
        }
    </style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>
<body>
    <div class="d-flex">
        <div class="sidebar">
            <h4 class="mb-4">発注管理</h4>
            <a href="#">ダッシュボード</a>
            <a href="#" class="active">発注一覧</a>
                        <a href="#">仕入先管理</a>
            <a href="#">発注書出力</a>
            <a href="#">設定</a>
        </div>
        <div class="d-flex flex-column flex-grow-1">
            <div class="topbar d-flex justify-content-between align-items-center">
                <h5 class="mb-0">発注一覧</h5>
                <div>
                    <button class="btn btn-outline-primary btn-sm">CSV出力</button>
                    <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#newOrderModal">新規発注</button>
                </div>
            </div>
            <div class="main" style="background-color: #f4f6f9;">
                <div class="card shadow-sm p-3 mb-4 search-area">
                    <div class="row">
                        <div class="col-md-3">
                            <label class="form-label">発注ID</label>
                            <input type="text" class="form-control" placeholder="例：H2025001">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">発注者</label>
                            <input type="text" class="form-control">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">発注日（FROM）</label>
                            <input type="date" class="form-control">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">発注日（TO）</label>
                            <input type="date" class="form-control">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">ステータス</label>
                            <select class="form-control">
                                <option>すべて</option>
                                <option>承認待ち</option>
                                <option>承認済</option>
                                <option>却下</option>
                            </select>
                        </div>
                        <div class="col-md-9 text-end align-self-end">
                            <button class="btn btn-primary me-2">検索</button>
                            <button class="btn btn-secondary">クリア</button>
                        </div>
                    </div>
                </div>

                <table class="table table-bordered table-hover align-middle">
                    <thead>
                        <tr>
                            <th>発注ID</th>
                            <th>発注日</th>
                            <th>発注者</th>
                            <th>仕入先</th>
                            <th>商品数</th>
                            <th>合計金額</th>
                            <th>ステータス</th>
                            <th class="text-center">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>H20250701</td>
                            <td>2025/07/01</td>
                            <td>山田太郎</td>
                            <td>〇〇商事</td>
                            <td>5</td>
                            <td>¥450,000</td>
                            <td><span class="badge bg-warning text-dark badge-status">承認待ち</span></td>
                            <td class="text-center action-buttons">
                                <button class="btn btn-sm btn-outline-primary">詳細</button>
                                <button class="btn btn-sm btn-outline-warning">編集</button>
                                <button class="btn btn-sm btn-outline-danger">削除</button>
                            </td>
                        </tr>
                        <tr>
                            <td>H20250702</td>
                            <td>2025/07/02</td>
                            <td>佐藤花子</td>
                            <td>△△機器</td>
                            <td>2</td>
                            <td>¥120,000</td>
                            <td><span class="badge bg-success badge-status">承認済</span></td>
                            <td class="text-center action-buttons">
                                <button class="btn btn-sm btn-outline-primary">詳細</button>
                                <button class="btn btn-sm btn-outline-warning" disabled>編集</button>
                                <button class="btn btn-sm btn-outline-danger" disabled>削除</button>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="d-flex justify-content-between align-items-center mt-3">
                    <div class="pagination-info">1-2件 / 全2件</div>
                    <nav>
                        <ul class="pagination pagination-sm mb-0">
                            <li class="page-item disabled"><a class="page-link" href="#">前へ</a></li>
                            <li class="page-item active"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">次へ</a></li>
                        </ul>
                    </nav>
                </div>

            </div>
        </div>
    </div>

<!-- 発注登録モーダル -->
<div class="modal fade" id="newOrderModal" tabindex="-1" aria-labelledby="newOrderModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-light">
        <h5 class="modal-title" id="newOrderModalLabel">新規発注登録</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
      </div>
      <div class="modal-body">
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="orderDate" class="form-label">発注日</label>
            <input type="date" class="form-control" id="orderDate">
          </div>
          <div class="col-md-6">
            <label for="orderUser" class="form-label">発注者名</label>
            <input type="text" class="form-control" id="orderUser" placeholder="例：山田太郎">
          </div>
        </div>
        <hr>
        <h6>商品情報</h6>
        <div id="productList">
          <div class="row g-2 mb-2">
            <div class="col-md-5"><input type="text" class="form-control" placeholder="商品名"></div>
            <div class="col-md-2"><input type="number" class="form-control" placeholder="数量" value="1"></div>
            <div class="col-md-3"><input type="number" class="form-control" placeholder="単価" value="0"></div>
            <div class="col-md-2"><button class="btn btn-danger w-100" onclick="removeProductRow(this)">削除</button></div>
          </div>
        </div>
        <button class="btn btn-outline-primary btn-sm mb-3" onclick="addProductRow()">＋ 商品追加</button>

        <div class="mb-3">
          <label for="note" class="form-label">備考</label>
          <textarea id="note" class="form-control" rows="2" placeholder="必要に応じて入力"></textarea>
        </div>
        <div class="alert alert-warning d-none" id="orderWarning">※ 発注者名と商品を入力してください。</div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
        <button class="btn btn-primary" onclick="submitOrder()">登録</button>
      </div>
    </div>
  </div>
</div>


<script>
function addProductRow() {
  const row = `
    <div class="row g-2 mb-2">
      <div class="col-md-5"><input type="text" class="form-control" placeholder="商品名"></div>
      <div class="col-md-2"><input type="number" class="form-control" placeholder="数量" value="1"></div>
      <div class="col-md-3"><input type="number" class="form-control" placeholder="単価" value="0"></div>
      <div class="col-md-2"><button class="btn btn-danger w-100" onclick="removeProductRow(this)">削除</button></div>
    </div>`;
  document.getElementById("productList").insertAdjacentHTML("beforeend", row);
}

function removeProductRow(btn) {
  btn.closest(".row").remove();
}

function submitOrder() {
  const user = document.getElementById("orderUser").value.trim();
  const products = document.querySelectorAll("#productList input[placeholder='商品名']");
  let hasProduct = false;
  products.forEach(p => { if (p.value.trim()) hasProduct = true; });
  if (!user || !hasProduct) {
    document.getElementById("orderWarning").classList.remove("d-none");
    return;
  }
  alert("登録完了！（※実際の登録処理は未実装）");
  const modal = bootstrap.Modal.getInstance(document.getElementById("newOrderModal"));
  modal.hide();
}
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


<!-- 編集モーダル -->
<div class="modal fade" id="editOrderModal" tabindex="-1" aria-labelledby="editOrderModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-light">
        <h5 class="modal-title" id="editOrderModalLabel">発注編集</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
      </div>
      <div class="modal-body">
        <div class="row mb-3">
          <div class="col-md-6">
            <label class="form-label">発注日</label>
            <input type="date" class="form-control" id="editDate" value="2025-07-01">
          </div>
          <div class="col-md-6">
            <label class="form-label">発注者名</label>
            <input type="text" class="form-control" id="editUser" value="山田太郎">
          </div>
        </div>
        <h6>商品情報</h6>
        <div id="editProductList">
          <div class="row g-2 mb-2">
            <div class="col-md-5"><input type="text" class="form-control" value="ノートPC"></div>
            <div class="col-md-2"><input type="number" class="form-control" value="5"></div>
            <div class="col-md-3"><input type="number" class="form-control" value="90000"></div>
            <div class="col-md-2"><button class="btn btn-danger w-100" onclick="removeProductRow(this)">削除</button></div>
          </div>
        </div>
        <button class="btn btn-outline-primary btn-sm mb-3" onclick="addEditProductRow()">＋ 商品追加</button>
        <div class="mb-3">
          <label class="form-label">備考</label>
          <textarea class="form-control" rows="2">至急納品希望</textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
        <button class="btn btn-primary" onclick="alert('保存完了（未実装）')">保存</button>
      </div>
    </div>
  </div>
</div>

<script>
function addEditProductRow() {
  const row = `
    <div class="row g-2 mb-2">
      <div class="col-md-5"><input type="text" class="form-control" placeholder="商品名"></div>
      <div class="col-md-2"><input type="number" class="form-control" placeholder="数量" value="1"></div>
      <div class="col-md-3"><input type="number" class="form-control" placeholder="単価" value="0"></div>
      <div class="col-md-2"><button class="btn btn-danger w-100" onclick="removeProductRow(this)">削除</button></div>
    </div>`;
  document.getElementById("editProductList").insertAdjacentHTML("beforeend", row);
}

// 替换编辑按钮点击逻辑
document.querySelectorAll("button.btn-outline-warning").forEach(btn => {
  btn.setAttribute("data-bs-toggle", "modal");
  btn.setAttribute("data-bs-target", "#editOrderModal");
});
</script>

</body>
</html>
